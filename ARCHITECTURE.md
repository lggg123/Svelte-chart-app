# ğŸ—ï¸ Application Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BROWSER (Client)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              App.svelte (Main UI)                   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚   Header    â”‚  â”‚ Symbol Info  â”‚  â”‚  Footer   â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  & Search   â”‚  â”‚  & Price     â”‚  â”‚           â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚       ChartControls.svelte                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  [1M] [5M] [15M] [1H] [4H] [1D] [1W]       â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  [ ] Volume  [ ] Moving Averages            â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚     CandlestickChart.svelte                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                               â”‚   â”‚    â”‚
â”‚  â”‚  â”‚     [Canvas Element]                         â”‚   â”‚    â”‚
â”‚  â”‚  â”‚     â€¢ Draws candlesticks                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚     â€¢ Draws volume bars                      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚     â€¢ Draws grid & axes                      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚     â€¢ Draws pattern markers                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                               â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚       PatternsList.svelte                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  [ğŸŸ¢ Hammer] [ğŸ”´ Doji] [ğŸŸ¢ Engulfing]      â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚       WebSocketManager.svelte (Hidden)             â”‚    â”‚
â”‚  â”‚       â€¢ Manages WebSocket connection               â”‚    â”‚
â”‚  â”‚       â€¢ Handles reconnection logic                 â”‚    â”‚
â”‚  â”‚       â€¢ Updates stores with incoming data          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ â†‘
                    WebSocket (WS)
                          â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND SERVER                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         HTTP API (Port 8002)                        â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/picks/top/:count                       â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/stock/:symbol                          â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/patterns/:symbol                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚      WebSocket Server (Port 8003)                   â”‚    â”‚
â”‚  â”‚  â€¢ WS /ws/live/:symbol                             â”‚    â”‚
â”‚  â”‚  â€¢ Streams candlestick data                        â”‚    â”‚
â”‚  â”‚  â€¢ Sends pattern detections                        â”‚    â”‚
â”‚  â”‚  â€¢ Sends heartbeats                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
App.svelte
â”œâ”€â”€ WebSocketManager.svelte (manages data flow)
â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Logo & Title
â”‚   â”œâ”€â”€ Connection Status Badge
â”‚   â””â”€â”€ Symbol Search Input
â”œâ”€â”€ Symbol Info Panel
â”‚   â”œâ”€â”€ Symbol Name
â”‚   â”œâ”€â”€ Current Price
â”‚   â””â”€â”€ Price Change
â”œâ”€â”€ ChartControls.svelte
â”‚   â”œâ”€â”€ Timeframe Buttons
â”‚   â””â”€â”€ Indicator Toggles
â”œâ”€â”€ CandlestickChart.svelte
â”‚   â””â”€â”€ Canvas (renders chart)
â”œâ”€â”€ PatternsList.svelte
â”‚   â””â”€â”€ Pattern Cards
â””â”€â”€ Footer
```

## Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATA STORES                          â”‚
â”‚                    (stores.js)                           â”‚
â”‚                                                          â”‚
â”‚  â€¢ candles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â€¢ patterns â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                             â”‚
â”‚  â€¢ currentPrice â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                             â”‚
â”‚  â€¢ isConnected â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€> Reactive Updates     â”‚
â”‚  â€¢ selectedSymbol â”€â”€â”€â”€â”€â”€â”€â”¤                             â”‚
â”‚  â€¢ selectedTimeframe â”€â”€â”€â”€â”¤                             â”‚
â”‚  â€¢ priceChange (derived) â”¤                             â”‚
â”‚  â€¢ candleStats (derived) â”˜                             â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘                              â†“
         â”‚                              â”‚
         â”‚ Update                       â”‚ Subscribe
         â”‚                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WebSocket       â”‚         â”‚    UI Components       â”‚
â”‚  Manager         â”‚         â”‚                        â”‚
â”‚                  â”‚         â”‚  â€¢ App.svelte          â”‚
â”‚  â€¢ Receives data â”‚         â”‚  â€¢ CandlestickChart    â”‚
â”‚  â€¢ Parses JSON   â”‚         â”‚  â€¢ ChartControls       â”‚
â”‚  â€¢ Updates storesâ”‚         â”‚  â€¢ PatternsList        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## WebSocket Message Flow

```
1. Connection Established
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client   â”‚â”€â”€â”€â”€Connectâ”€â”€>â”‚  Server  â”‚
   â”‚          â”‚<â”€â”€â”€Acceptâ”€â”€â”€â”€â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. Historical Data
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client   â”‚              â”‚  Server  â”‚
   â”‚          â”‚<â”€â”€â”€100 barsâ”€â”€â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€> candles.set([...])
        â””â”€> Chart renders

3. Live Updates (every 2 seconds)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client   â”‚              â”‚  Server  â”‚
   â”‚          â”‚<â”€New candleâ”€â”€â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€> candles.update()
        â”œâ”€> currentPrice.set()
        â””â”€> Chart re-renders

4. Pattern Detection (random)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client   â”‚              â”‚  Server  â”‚
   â”‚          â”‚<â”€â”€Patternâ”€â”€â”€â”€â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€> patterns.update()
        â”œâ”€> Show notification
        â””â”€> Add marker to chart

5. Heartbeat (every 30 seconds)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client   â”‚              â”‚  Server  â”‚
   â”‚          â”‚<â”€Heartbeatâ”€â”€â”€â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â””â”€> Keep connection alive
```

## Canvas Rendering Pipeline

```
draw() function called
    â†“
Clear canvas
    â†“
Calculate scales (price range, time range)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Draw Background    â”‚
â”‚  â€¢ Grid lines       â”‚
â”‚  â€¢ Price levels     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Draw Volume Bars   â”‚
â”‚  â€¢ Green (bullish)  â”‚
â”‚  â€¢ Red (bearish)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Draw Candlesticks  â”‚
â”‚  For each candle:   â”‚
â”‚    â€¢ Draw wick      â”‚
â”‚    â€¢ Draw body      â”‚
â”‚    â€¢ Color by trend â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Draw Pattern       â”‚
â”‚  Markers            â”‚
â”‚  â€¢ ğŸŸ¢/ğŸ”´ icons     â”‚
â”‚  â€¢ Pattern labels   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Draw Price Axis    â”‚
â”‚  â€¢ Y-axis labels    â”‚
â”‚  â€¢ Current price    â”‚
â”‚  â€¢ Price line       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Render to screen
```

## State Management

```
User Actions â†’ Components â†’ Stores â†’ All Subscribers
                    â†“
              WebSocket Manager
                    â†“
              API Calls / WS Messages
```

### Example: Changing Symbol

```
1. User types "TSLA" and presses Enter
   â†“
2. handleSymbolSearch() in App.svelte
   â†“
3. selectedSymbol.set("TSLA")
   â†“
4. WebSocketManager reactive statement triggers
   â†“
5. Disconnect old WebSocket
   â†“
6. Clear candles and patterns stores
   â†“
7. Connect new WebSocket for TSLA
   â†“
8. Receive historical data
   â†“
9. Update candles store
   â†“
10. Chart component re-renders with new data
```

## Performance Optimizations

1. **Canvas Rendering**
   - Hardware-accelerated
   - Only redraws on data changes
   - Uses requestAnimationFrame

2. **Data Limits**
   - Max 500 candles in memory
   - Display last 100 candles
   - Automatic cleanup of old data

3. **WebSocket**
   - Automatic reconnection
   - Heartbeat to keep alive
   - Efficient JSON parsing

4. **Svelte Reactivity**
   - Fine-grained updates
   - Only affected components re-render
   - Derived stores for computed values

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend Stack                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Svelte 5         â”‚ UI Framework       â”‚
â”‚ Vite             â”‚ Build Tool         â”‚
â”‚ Canvas API       â”‚ Chart Rendering    â”‚
â”‚ WebSocket API    â”‚ Real-time Data     â”‚
â”‚ D3 (scale/shape) â”‚ Data Utilities     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Backend Stack (Mock)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Node.js          â”‚ Runtime            â”‚
â”‚ HTTP Module      â”‚ REST API           â”‚
â”‚ WS Package       â”‚ WebSocket Server   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Structure & Responsibilities

```
src/
â”œâ”€â”€ App.svelte
â”‚   â””â”€â”€ Main layout and composition
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api.js
â”‚   â”‚   â””â”€â”€ HTTP API service wrapper
â”‚   â”‚
â”‚   â”œâ”€â”€ stores.js
â”‚   â”‚   â””â”€â”€ Global state management
â”‚   â”‚
â”‚   â”œâ”€â”€ WebSocketManager.svelte
â”‚   â”‚   â”œâ”€â”€ Connection lifecycle
â”‚   â”‚   â”œâ”€â”€ Message handling
â”‚   â”‚   â””â”€â”€ Store updates
â”‚   â”‚
â”‚   â”œâ”€â”€ CandlestickChart.svelte
â”‚   â”‚   â”œâ”€â”€ Canvas rendering
â”‚   â”‚   â”œâ”€â”€ Drawing functions
â”‚   â”‚   â””â”€â”€ Price calculations
â”‚   â”‚
â”‚   â”œâ”€â”€ ChartControls.svelte
â”‚   â”‚   â”œâ”€â”€ Timeframe selector
â”‚   â”‚   â””â”€â”€ Indicator toggles
â”‚   â”‚
â”‚   â””â”€â”€ PatternsList.svelte
â”‚       â”œâ”€â”€ Pattern cards
â”‚       â””â”€â”€ Pattern formatting
â”‚
â””â”€â”€ main.js
    â””â”€â”€ App initialization
```

## Security Considerations

1. **WebSocket**
   - Use WSS in production
   - Implement authentication
   - Validate all incoming data

2. **API**
   - Use HTTPS in production
   - Add API key authentication
   - Rate limiting

3. **Environment Variables**
   - Never commit `.env` to git
   - Use different configs per environment
   - Secure sensitive data

## Scalability Notes

**Current Limits:**
- 100 visible candles
- 500 candles in memory
- 2 second update interval

**To Scale:**
- Implement virtual scrolling
- Use Web Workers for calculations
- Add data pagination
- Implement caching strategy
- Use CDN for static assets

---

This architecture provides:
- âœ… Real-time updates
- âœ… Smooth performance
- âœ… Clean separation of concerns
- âœ… Easy to maintain and extend
- âœ… Production-ready structure
